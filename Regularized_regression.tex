% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\definecolor{QuartoInternalColor9}{rgb}{0.60,0.00,1.00}
\definecolor{QuartoInternalColor2}{rgb}{0,0,0}
\definecolor{QuartoInternalColor6}{rgb}{0.87,0.71,0.17}
\definecolor{QuartoInternalColor4}{rgb}{0.38,0.38,0.38}
\definecolor{QuartoInternalColor1}{rgb}{0.91,0.36,0.35}
\definecolor{QuartoInternalColor10}{rgb}{0.20,0.40,0.40}
\definecolor{QuartoInternalColor14}{rgb}{0.80,0.20,0.20}
\definecolor{QuartoInternalColor3}{rgb}{0.00,0.64,0.31}
\definecolor{QuartoInternalColor5}{rgb}{0.15,0.56,0.56}
\definecolor{QuartoInternalColor13}{rgb}{0.74,0.74,0.74}
\definecolor{QuartoInternalColor12}{rgb}{0.00,0.00,1.00}
\definecolor{QuartoInternalColor11}{rgb}{0.60,0.00,0.00}
\definecolor{QuartoInternalColor8}{rgb}{0.00,0.40,0.00}
\definecolor{QuartoInternalColor16}{rgb}{0.60,0.20,0.00}
\definecolor{QuartoInternalColor7}{rgb}{0.00,0.45,0.15}
\definecolor{QuartoInternalColor15}{rgb}{0.60,0.20,0.40}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={REGULARIZED REGRESSION},
  pdfauthor={Kwabena Asabere},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{REGULARIZED REGRESSION}
\author{Kwabena Asabere}
\date{}

\begin{document}
\maketitle


\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ seaborn }\ImportTok{as}\NormalTok{ sns}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ sklearn.linear\_model }\ImportTok{import}\NormalTok{ Ridge,Lasso,RidgeCV,LassoCV,ElasticNetCV,ElasticNet}
\ImportTok{from}\NormalTok{ sklearn.preprocessing }\ImportTok{import}\NormalTok{ StandardScaler,OneHotEncoder,PolynomialFeatures,FunctionTransformer}
\ImportTok{from}\NormalTok{ sklearn.pipeline }\ImportTok{import}\NormalTok{ Pipeline,make\_pipeline}
\ImportTok{from}\NormalTok{ sklearn.model\_selection }\ImportTok{import}\NormalTok{ train\_test\_split,cross\_val\_score,cross\_validate,cross\_val\_predict,GridSearchCV}
\ImportTok{from}\NormalTok{ sklearn.metrics }\ImportTok{import}\NormalTok{ root\_mean\_squared\_error,mean\_squared\_error}
\ImportTok{from}\NormalTok{ sklearn.compose }\ImportTok{import}\NormalTok{ ColumnTransformer}
\ImportTok{from}\NormalTok{ sklearn.impute }\ImportTok{import}\NormalTok{ SimpleImputer}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\VerbatimStringTok{r"C:\textbackslash{}Users\textbackslash{}KAsab\textbackslash{}Desktop\textbackslash{}PYTHON\textbackslash{}california\_housing.csv"}\NormalTok{,engine }\OperatorTok{=} \StringTok{"pyarrow"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing.head()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lllllllllll@{}}
\toprule\noalign{}
& longitude & latitude & housing\_median\_age & total\_rooms &
total\_bedrooms & population & households & median\_income &
median\_house\_value & ocean\_proximity \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & -122.23 & 37.88 & 41.0 & 880.0 & 129.0 & 322.0 & 126.0 & 8.3252 &
452600.0 & NEAR BAY \\
1 & -122.22 & 37.86 & 21.0 & 7099.0 & 1106.0 & 2401.0 & 1138.0 & 8.3014
& 358500.0 & NEAR BAY \\
2 & -122.24 & 37.85 & 52.0 & 1467.0 & 190.0 & 496.0 & 177.0 & 7.2574 &
352100.0 & NEAR BAY \\
3 & -122.25 & 37.85 & 52.0 & 1274.0 & 235.0 & 558.0 & 219.0 & 5.6431 &
341300.0 & NEAR BAY \\
4 & -122.25 & 37.85 & 52.0 & 1627.0 & 280.0 & 565.0 & 259.0 & 3.8462 &
342200.0 & NEAR BAY \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing.info()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   longitude           20640 non-null  float64
 1   latitude            20640 non-null  float64
 2   housing_median_age  20640 non-null  float64
 3   total_rooms         20640 non-null  float64
 4   total_bedrooms      20433 non-null  float64
 5   population          20640 non-null  float64
 6   households          20640 non-null  float64
 7   median_income       20640 non-null  float64
 8   median_house_value  20640 non-null  float64
 9   ocean_proximity     20640 non-null  object 
dtypes: float64(9), object(1)
memory usage: 1.6+ MB
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing.isna().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
longitude               0
latitude                0
housing_median_age      0
total_rooms             0
total_bedrooms        207
population              0
households              0
median_income           0
median_house_value      0
ocean_proximity         0
dtype: int64
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing[}\StringTok{"total\_bedrooms"}\NormalTok{]}\OperatorTok{=}\NormalTok{housing[}\StringTok{"total\_bedrooms"}\NormalTok{].fillna(housing[}\StringTok{"total\_bedrooms"}\NormalTok{].median())}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing.isna().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
longitude             0
latitude              0
housing_median_age    0
total_rooms           0
total_bedrooms        0
population            0
households            0
median_income         0
median_house_value    0
ocean_proximity       0
dtype: int64
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing[}\StringTok{"rooms\_per\_house"}\NormalTok{] }\OperatorTok{=}\NormalTok{ housing[}\StringTok{\textquotesingle{}total\_bedrooms\textquotesingle{}}\NormalTok{]}\OperatorTok{/}\NormalTok{housing[}\StringTok{"total\_rooms"}\NormalTok{]}
\NormalTok{housing[}\StringTok{"people\_per\_house"}\NormalTok{] }\OperatorTok{=}\NormalTok{ housing[}\StringTok{"population"}\NormalTok{]}\OperatorTok{/}\NormalTok{housing[}\StringTok{"households"}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{housing.head()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lllllllllllll@{}}
\toprule\noalign{}
& longitude & latitude & housing\_median\_age & total\_rooms &
total\_bedrooms & population & households & median\_income &
median\_house\_value & ocean\_proximity & rooms\_per\_house &
people\_per\_house \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & -122.23 & 37.88 & 41.0 & 880.0 & 129.0 & 322.0 & 126.0 & 8.3252 &
452600.0 & NEAR BAY & 0.146591 & 2.555556 \\
1 & -122.22 & 37.86 & 21.0 & 7099.0 & 1106.0 & 2401.0 & 1138.0 & 8.3014
& 358500.0 & NEAR BAY & 0.155797 & 2.109842 \\
2 & -122.24 & 37.85 & 52.0 & 1467.0 & 190.0 & 496.0 & 177.0 & 7.2574 &
352100.0 & NEAR BAY & 0.129516 & 2.802260 \\
3 & -122.25 & 37.85 & 52.0 & 1274.0 & 235.0 & 558.0 & 219.0 & 5.6431 &
341300.0 & NEAR BAY & 0.184458 & 2.547945 \\
4 & -122.25 & 37.85 & 52.0 & 1627.0 & 280.0 & 565.0 & 259.0 & 3.8462 &
342200.0 & NEAR BAY & 0.172096 & 2.181467 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric\_features }\OperatorTok{=}\NormalTok{ [}\StringTok{"rooms\_per\_house"}\NormalTok{,}\StringTok{"people\_per\_house"}\NormalTok{]}
\NormalTok{log\_features }\OperatorTok{=}\NormalTok{ housing.iloc[:,:}\DecValTok{8}\NormalTok{].columns.to\_list()}
\NormalTok{cat\_features }\OperatorTok{=}\NormalTok{ housing.select\_dtypes(include }\OperatorTok{=} \StringTok{"object"}\NormalTok{).columns.to\_list()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OperatorTok{=}\NormalTok{ housing.drop(columns }\OperatorTok{=}\NormalTok{ [}\StringTok{"median\_house\_value"}\NormalTok{])}
\NormalTok{y }\OperatorTok{=}\NormalTok{ housing[}\StringTok{"median\_house\_value"}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X\_train.info()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
Index: 16512 entries, 14196 to 15795
Data columns (total 11 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   longitude           16512 non-null  float64
 1   latitude            16512 non-null  float64
 2   housing_median_age  16512 non-null  float64
 3   total_rooms         16512 non-null  float64
 4   total_bedrooms      16512 non-null  float64
 5   population          16512 non-null  float64
 6   households          16512 non-null  float64
 7   median_income       16512 non-null  float64
 8   ocean_proximity     16512 non-null  object 
 9   rooms_per_house     16512 non-null  float64
 10  people_per_house    16512 non-null  float64
dtypes: float64(10), object(1)
memory usage: 1.5+ MB
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X\_train, X\_test, y\_train, y\_test }\OperatorTok{=}\NormalTok{ train\_test\_split(X, y, test\_size}\OperatorTok{=}\FloatTok{0.2}\NormalTok{, random\_state}\OperatorTok{=}\DecValTok{42}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric\_transformer }\OperatorTok{=}\NormalTok{ Pipeline( steps }\OperatorTok{=}\NormalTok{ [}
\NormalTok{    (}\StringTok{"imputer"}\NormalTok{,SimpleImputer(strategy }\OperatorTok{=} \StringTok{"mean"}\NormalTok{)),}
\NormalTok{    (}\StringTok{"scaler"}\NormalTok{,StandardScaler())}
\NormalTok{])}

\NormalTok{log\_transformer }\OperatorTok{=}\NormalTok{ Pipeline(steps }\OperatorTok{=}\NormalTok{ [}
\NormalTok{    (}\StringTok{"imputer"}\NormalTok{,SimpleImputer(strategy }\OperatorTok{=} \StringTok{"mean"}\NormalTok{)),}
\NormalTok{    (}\StringTok{"log"}\NormalTok{,FunctionTransformer(np.log1p))}
\NormalTok{])}

\NormalTok{cat\_transformer }\OperatorTok{=}\NormalTok{ Pipeline(steps }\OperatorTok{=}\NormalTok{ [}
\NormalTok{    (}\StringTok{"imputer"}\NormalTok{,SimpleImputer(strategy }\OperatorTok{=} \StringTok{"most\_frequent"}\NormalTok{)),}
\NormalTok{    (}\StringTok{"onehot"}\NormalTok{,OneHotEncoder(handle\_unknown }\OperatorTok{=} \StringTok{"ignore"}\NormalTok{,sparse\_output }\OperatorTok{=} \VariableTok{False}\NormalTok{))}
\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{preprocessor }\OperatorTok{=}\NormalTok{ ColumnTransformer(transformers }\OperatorTok{=}\NormalTok{[}
\NormalTok{    (}\StringTok{"log"}\NormalTok{,log\_transformer,log\_features),}
\NormalTok{    (}\StringTok{"num"}\NormalTok{,numeric\_transformer,numeric\_features),}
\NormalTok{    (}\StringTok{"cat"}\NormalTok{,cat\_transformer,cat\_features)}
\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pipeline }\OperatorTok{=}\NormalTok{ Pipeline( steps }\OperatorTok{=}\NormalTok{ [}
\NormalTok{    (}\StringTok{"preprocessor"}\NormalTok{,preprocessor),}
\NormalTok{    (}\StringTok{"ridge"}\NormalTok{,Ridge())}
\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{param\_grid }\OperatorTok{=}\NormalTok{ \{}
    \StringTok{"ridge\_\_alpha"}\NormalTok{:[}\FloatTok{0.1}\NormalTok{,}\FloatTok{1.0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{100}\NormalTok{,}\DecValTok{1000}\NormalTok{]}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

The names of the hyperparameters in the \texttt{param\_grid} must
contain the name of the step in the pipeline followed by 2 underscores
and then the hyperparameter.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grid }\OperatorTok{=}\NormalTok{ GridSearchCV(pipeline,param\_grid,cv }\OperatorTok{=} \DecValTok{5}\NormalTok{,scoring }\OperatorTok{=} \StringTok{"neg\_root\_mean\_squared\_error"}\NormalTok{,n\_jobs }\OperatorTok{=} \OperatorTok{{-}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grid.fit(X\_train,y\_train)}
\end{Highlighting}
\end{Shaded}

\begin{Highlighting}
\textcolor{black}{ValueError: }
\textcolor{black}{All the 25 fits failed.}
\textcolor{black}{It is very likely that your model is misconfigured.}
\textcolor{black}{You can try to debug the error by setting error_score='raise'.}
\textcolor{black}{Below are more details about the failures:}
\textcolor{black}{--------------------------------------------------------------------------------}
\textcolor{black}{25 fits failed with the following error:}
\textcolor{black}{Traceback (most recent call last):}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\model_selection\_validation.py", line 895, in _fit_and_score}
\textcolor{black}{    estimator.fit(X_train, y_train, **fit_params)}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\base.py", line 1474, in wrapper}
\textcolor{black}{    return fit_method(estimator, *args, **kwargs)}
\textcolor{black}{           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\pipeline.py", line 475, in fit}
\textcolor{black}{    self._final_estimator.fit(Xt, y, **last_step_params["fit"])}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\base.py", line 1474, in wrapper}
\textcolor{black}{    return fit_method(estimator, *args, **kwargs)}
\textcolor{black}{           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\linear_model\_ridge.py", line 1167, in fit}
\textcolor{black}{    X, y = self._validate_data(}
\textcolor{black}{           ^^^^^^^^^^^^^^^^^^^^}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\base.py", line 650, in _validate_data}
\textcolor{black}{    X, y = check_X_y(X, y, **check_params)}
\textcolor{black}{           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1263, in check_X_y}
\textcolor{black}{    X = check_array(}
\textcolor{black}{        ^^^^^^^^^^^^}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array}
\textcolor{black}{    _assert_all_finite(}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite}
\textcolor{black}{    _assert_all_finite_element_wise(}
\textcolor{black}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise}
\textcolor{black}{    raise ValueError(msg_err)}
\textcolor{black}{ValueError: Input X contains NaN.}
\textcolor{black}{Ridge does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values}
\textcolor{black}{}\textcolor{QuartoInternalColor1}{---------------------------------------------------------------------------}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor1}{ValueError}\textcolor{QuartoInternalColor2}{                                Traceback (most recent call last)}
\textcolor{QuartoInternalColor2}{Cell }\textcolor{QuartoInternalColor3}{In[395], line 1}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{----> 1}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor2}{grid}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{fit}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{X_train}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{,}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{y_train}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{File }\textcolor{QuartoInternalColor3}{~\anaconda3\Lib\site-packages\sklearn\base.py:1474}\textcolor{QuartoInternalColor2}{, in }\textcolor{QuartoInternalColor5}{_fit_context.<locals>.decorator.<locals>.wrapper}\textcolor{QuartoInternalColor6}{(estimator, *args, **kwargs)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1467}\textcolor{QuartoInternalColor2}{     estimator}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{_validate_params()}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1469}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{with}\textcolor{QuartoInternalColor2}{ config_context(}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1470}\textcolor{QuartoInternalColor2}{     skip_parameter_validation}\textcolor{QuartoInternalColor4}{=}\textcolor{QuartoInternalColor2}{(}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1471}\textcolor{QuartoInternalColor2}{         prefer_skip_nested_validation }\textcolor{QuartoInternalColor9}{or}\textcolor{QuartoInternalColor2}{ global_skip_validation}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1472}\textcolor{QuartoInternalColor2}{     )}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1473}\textcolor{QuartoInternalColor2}{ ):}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{-> 1474}\textcolor{QuartoInternalColor2}{     }\textcolor{QuartoInternalColor8}{return}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor2}{fit_method}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{estimator}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{,}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{*}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{args}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{,}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{*}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{*}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{kwargs}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{File }\textcolor{QuartoInternalColor3}{~\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py:970}\textcolor{QuartoInternalColor2}{, in }\textcolor{QuartoInternalColor5}{BaseSearchCV.fit}\textcolor{QuartoInternalColor6}{(self, X, y, **params)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    964}\textcolor{QuartoInternalColor2}{     results }\textcolor{QuartoInternalColor4}{=}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{self}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{_format_results(}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    965}\textcolor{QuartoInternalColor2}{         all_candidate_params, n_splits, all_out, all_more_results}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    966}\textcolor{QuartoInternalColor2}{     )}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    968}\textcolor{QuartoInternalColor2}{     }\textcolor{QuartoInternalColor8}{return}\textcolor{QuartoInternalColor2}{ results}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{--> 970}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{self}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{_run_search}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{evaluate_candidates}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    972}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor10}{# multimetric is determined here because in the case of a callable}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    973}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor10}{# self.scoring the return type is only known after calling}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    974}\textcolor{QuartoInternalColor2}{ first_test_score }\textcolor{QuartoInternalColor4}{=}\textcolor{QuartoInternalColor2}{ all_out[}\textcolor{QuartoInternalColor4}{0}\textcolor{QuartoInternalColor2}{][}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{test_scores}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{]}
\textcolor{QuartoInternalColor2}{File }\textcolor{QuartoInternalColor3}{~\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py:1527}\textcolor{QuartoInternalColor2}{, in }\textcolor{QuartoInternalColor5}{GridSearchCV._run_search}\textcolor{QuartoInternalColor6}{(self, evaluate_candidates)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1525}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{def}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor12}{_run_search}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor8}{self}\textcolor{QuartoInternalColor2}{, evaluate_candidates):}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{   1526}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor13}{    }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"""Search all candidates in param_grid"""}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{-> 1527}\textcolor{QuartoInternalColor2}{     }\textcolor{QuartoInternalColor2}{evaluate_candidates}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{ParameterGrid}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor8}{self}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{param_grid}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{)}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{File }\textcolor{QuartoInternalColor3}{~\anaconda3\Lib\site-packages\sklearn\model_selection\_search.py:947}\textcolor{QuartoInternalColor2}{, in }\textcolor{QuartoInternalColor5}{BaseSearchCV.fit.<locals>.evaluate_candidates}\textcolor{QuartoInternalColor6}{(candidate_params, cv, more_results)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    940}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{elif}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{len}\textcolor{QuartoInternalColor2}{(out) }\textcolor{QuartoInternalColor4}{!=}\textcolor{QuartoInternalColor2}{ n_candidates }\textcolor{QuartoInternalColor4}{*}\textcolor{QuartoInternalColor2}{ n_splits:}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    941}\textcolor{QuartoInternalColor2}{     }\textcolor{QuartoInternalColor8}{raise}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor14}{ValueError}\textcolor{QuartoInternalColor2}{(}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    942}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{cv.split and cv.get_n_splits returned }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    943}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{inconsistent results. Expected }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{ }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    944}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{splits, got }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{format(n_splits, }\textcolor{QuartoInternalColor8}{len}\textcolor{QuartoInternalColor2}{(out) }\textcolor{QuartoInternalColor4}{/}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{/}\textcolor{QuartoInternalColor2}{ n_candidates)}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    945}\textcolor{QuartoInternalColor2}{     )}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{--> 947}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor2}{_warn_or_raise_about_fit_failures}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{out}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{,}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor8}{self}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{error_score}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor2}{)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    949}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor10}{# For callable self.scoring, the return type is only know after}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    950}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor10}{# calling. If the return type is a dictionary, the error scores}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    951}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor10}{# can now be inserted with the correct key. The type checking}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    952}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor10}{# of out will be done in `_insert_error_scores`.}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    953}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{if}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{callable}\textcolor{QuartoInternalColor2}{(}\textcolor{QuartoInternalColor8}{self}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor4}{.}\textcolor{QuartoInternalColor2}{scoring):}
\textcolor{QuartoInternalColor2}{File }\textcolor{QuartoInternalColor3}{~\anaconda3\Lib\site-packages\sklearn\model_selection\_validation.py:536}\textcolor{QuartoInternalColor2}{, in }\textcolor{QuartoInternalColor5}{_warn_or_raise_about_fit_failures}\textcolor{QuartoInternalColor6}{(results, error_score)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    529}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{if}\textcolor{QuartoInternalColor2}{ num_failed_fits }\textcolor{QuartoInternalColor4}{==}\textcolor{QuartoInternalColor2}{ num_fits:}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    530}\textcolor{QuartoInternalColor2}{     all_fits_failed_message }\textcolor{QuartoInternalColor4}{=}\textcolor{QuartoInternalColor2}{ (}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    531}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{f}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{All the }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}\textcolor{QuartoInternalColor2}{num_fits}\textcolor{QuartoInternalColor15}{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{ fits failed.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    532}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{It is very likely that your model is misconfigured.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    533}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{You can try to debug the error by setting error_score=}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{'}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{raise}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{'}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    534}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{f}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{Below are more details about the failures:}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}\textcolor{QuartoInternalColor2}{fit_errors_summary}\textcolor{QuartoInternalColor15}{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    535}\textcolor{QuartoInternalColor2}{     )}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{--> 536}\textcolor{QuartoInternalColor2}{     }\textcolor{QuartoInternalColor8}{raise}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor14}{ValueError}\textcolor{QuartoInternalColor2}{(all_fits_failed_message)}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    538}\textcolor{QuartoInternalColor2}{ }\textcolor{QuartoInternalColor8}{else}\textcolor{QuartoInternalColor2}{:}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    539}\textcolor{QuartoInternalColor2}{     some_fits_failed_message }\textcolor{QuartoInternalColor4}{=}\textcolor{QuartoInternalColor2}{ (}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    540}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{f}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}\textcolor{QuartoInternalColor2}{num_failed_fits}\textcolor{QuartoInternalColor15}{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{ fits failed out of a total of }\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}\textcolor{QuartoInternalColor2}{num_fits}\textcolor{QuartoInternalColor15}{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{.}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    541}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{The score on these train-test partitions for these parameters}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor3}{   (...)}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    545}\textcolor{QuartoInternalColor2}{         }\textcolor{QuartoInternalColor11}{f}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{Below are more details about the failures:}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor16}{\n}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor15}{{}\textcolor{QuartoInternalColor2}{fit_errors_summary}\textcolor{QuartoInternalColor15}{}}\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor11}{"}\textcolor{QuartoInternalColor2}{}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor7}{    546}\textcolor{QuartoInternalColor2}{     )}
\textcolor{QuartoInternalColor2}{}\textcolor{QuartoInternalColor1}{ValueError}\textcolor{QuartoInternalColor2}{: }
\textcolor{QuartoInternalColor2}{All the 25 fits failed.}
\textcolor{QuartoInternalColor2}{It is very likely that your model is misconfigured.}
\textcolor{QuartoInternalColor2}{You can try to debug the error by setting error_score='raise'.}
\textcolor{QuartoInternalColor2}{Below are more details about the failures:}
\textcolor{QuartoInternalColor2}{--------------------------------------------------------------------------------}
\textcolor{QuartoInternalColor2}{25 fits failed with the following error:}
\textcolor{QuartoInternalColor2}{Traceback (most recent call last):}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\model_selection\_validation.py", line 895, in _fit_and_score}
\textcolor{QuartoInternalColor2}{    estimator.fit(X_train, y_train, **fit_params)}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\base.py", line 1474, in wrapper}
\textcolor{QuartoInternalColor2}{    return fit_method(estimator, *args, **kwargs)}
\textcolor{QuartoInternalColor2}{           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\pipeline.py", line 475, in fit}
\textcolor{QuartoInternalColor2}{    self._final_estimator.fit(Xt, y, **last_step_params["fit"])}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\base.py", line 1474, in wrapper}
\textcolor{QuartoInternalColor2}{    return fit_method(estimator, *args, **kwargs)}
\textcolor{QuartoInternalColor2}{           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\linear_model\_ridge.py", line 1167, in fit}
\textcolor{QuartoInternalColor2}{    X, y = self._validate_data(}
\textcolor{QuartoInternalColor2}{           ^^^^^^^^^^^^^^^^^^^^}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\base.py", line 650, in _validate_data}
\textcolor{QuartoInternalColor2}{    X, y = check_X_y(X, y, **check_params)}
\textcolor{QuartoInternalColor2}{           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1263, in check_X_y}
\textcolor{QuartoInternalColor2}{    X = check_array(}
\textcolor{QuartoInternalColor2}{        ^^^^^^^^^^^^}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 1049, in check_array}
\textcolor{QuartoInternalColor2}{    _assert_all_finite(}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 126, in _assert_all_finite}
\textcolor{QuartoInternalColor2}{    _assert_all_finite_element_wise(}
\textcolor{QuartoInternalColor2}{  File "C:\Users\KAsab\anaconda3\Lib\site-packages\sklearn\utils\validation.py", line 175, in _assert_all_finite_element_wise}
\textcolor{QuartoInternalColor2}{    raise ValueError(msg_err)}
\textcolor{QuartoInternalColor2}{ValueError: Input X contains NaN.}
\textcolor{QuartoInternalColor2}{Ridge does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values}
\end{Highlighting}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Best parameters:}\SpecialCharTok{\{}\NormalTok{grid}\SpecialCharTok{.}\NormalTok{best\_params\_}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Best score:}\SpecialCharTok{\{}\NormalTok{grid}\SpecialCharTok{.}\NormalTok{best\_score\_}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y\_pred }\OperatorTok{=}\NormalTok{ grid.best\_estimator\_.predict(X\_test)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rmse }\OperatorTok{=}\NormalTok{ root\_mean\_squared\_error(y\_test,y\_pred)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{"Root Mean Squared Error:"}\NormalTok{ ,rmse)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ sklearn.metrics }\ImportTok{import}\NormalTok{ r2\_score}
\end{Highlighting}
\end{Shaded}





\end{document}
